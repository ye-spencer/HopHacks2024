<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Charity Searcher</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css"
    />
    <link rel="stylesheet" href="app.css" />
  </head>
  <body>
    <nav class="navbar fixed-top navbar-expand-lg bg-light">
      <div
        class="container-fluid d-flex justify-content-between align-items-center"
      >
        <!-- Left section: Title -->
        <a class="navbar-brand" href="#">Charity Searcher</a>

        <!-- Center section: Search bar -->
        <form class="d-flex mx-auto" role="search" id="search-form">
          <input
            class="form-control me-2"
            type="search"
            id="search-input"
            placeholder="Search by location or name"
            aria-label="Search"
            required
          />
          <button
            class="btn btn-outline-success"
            id="search-button"
            type="submit"
          >
            Search
          </button>
        </form>

        <!-- Right section: Filters -->
        <div class="nav-section-right">
          Filters:
          <div class="">
            <button type="button" class="btn btn-dark btn-xs">
              Non-Profits
            </button>
            <button type="button" class="btn btn-dark btn-xs">
              Food Banks
            </button>
            <button type="button" class="btn btn-dark btn-xs">
              Social Wellfare
            </button>
          </div>
        </div>
      </div>
    </nav>
    <div class="container" id="welcome">
      <div class="row">
        <div class="col-12">
          <h1 class="text-center mt-5">Welcome to Charity Searcher</h1>
          <p class="text-center">Find charities near you</p>
        </div>
      </div>
    </div>
    <!-- Container for Leaflet map -->
    <div id="map"></div>

    <!--script for button activation -->
    <script src="buttonscript.js"></script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    <script>
      // Creating map options
      var mapOptions = {
        center: [39.2904, -76.6122],
        zoom: 10,
      };

      // Creating a map object
      var map = new L.map("map", mapOptions);

      // Creating a Layer object
      var layer = new L.TileLayer(
        "http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
      );

      // Adding layer to the map
      map.addLayer(layer);

      // Creating a marker object and adding it to the map
      // var marker = new L.marker([39.2904, -76.6122], {
      //   title: "You are here",
      // }).addTo(map);

      // var marker2 = new L.marker([36.7783, 119.4179], {
      //   title: "California",
      // }).addTo(map);
    </script>
    <script>
      const apiKey = "66e5c9dda2d53417477509ybn603cd4";

      // Function to convert street address to coordinates
      function getCoordinates(address) {
        const url = `https://geocode.maps.co/search?q=${encodeURIComponent(
          address
        )}&api_key=${apiKey}`;

        // Make a GET request to the API
        fetch(url)
          .then((response) => {
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json(); // Parse the JSON data
          })
          .then((data) => {
            if (data && data.length > 0) {
              const { lat, lon } = data[0]; // Get the latitude and longitude from the first result
              console.log(`Latitude: ${lat}, Longitude: ${lon}`);
              map.setView([lat, lon], 10);
              var marker1 = new L.marker([lat, lon], {
                title: "",
              }).addTo(map);

              marker1.bindPopup("ASDFLASJDFLASJDFLKASJDFLKASJDLKF");
              marker1.on("mouseover", function () {
                marker.openPopup();
              });
              marker1.on("mouseout", function () {
                marker.openPopup();
              });

              return { latitude: lat, longitude: lon }; // Return coordinates
            } else {
              console.log("No results found for the address.");
              return null; // No coordinates found
            }
          })
          .catch((error) => {
            console.error(
              "There was a problem with the fetch operation:",
              error
            );
          });
      }
      //example usage
      document.getElementById("search-form").addEventListener(
        "submit",
        function (event) {
          event.preventDefault(); // Prevent the default form submission
          const inputValue = document.getElementById("search-input").value; // Get the input value
          console.log(inputValue); // You can use this value as needed
          // Add your search logic here
          // Example: alert('Searching for: ' + inputValue);
          const address = inputValue;
          console.log("TEST");
          console.log(getCoordinates(address));
          console.log(getCoordinates("Baltimore"));
        },
        { passive: false }
      );
    </script>
  </body>
</html>
